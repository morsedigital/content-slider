{"version":3,"file":"index.js","sources":["src/animating.js","src/nav_dots.js","src/index.js","src/touch_handler.js"],"sourcesContent":["const animatingSetup = (el, moveTo, transitionend) => {\n  el.classList.add('content-slider--animate');\n  el.addEventListener('transitionend', transitionend, true);\n  window.requestAnimationFrame(() => {\n    el.style.transform = `translateX(${moveTo})`;\n  });\n};\n\nconst clearAnimatingIn = ({ target: el }) => {\n  el.removeEventListener('transitionend', clearAnimatingIn, true);\n  if (el instanceof Element) {\n    el.classList.remove('content-slider--animate');\n    el.removeAttribute('aria-hidden');\n  }\n};\n\nconst clearAnimatingOut = ({ target: el }) => {\n  el.removeEventListener('transitionend', clearAnimatingOut, true);\n  if (el instanceof Element) {\n    el.classList.remove('content-slider--animate');\n    el.style.transform = 'translateX(-110%)';\n    el.setAttribute('aria-hidden', 'true');\n  }\n};\n\nconst animatingIn = animateIn => {\n  animatingSetup(animateIn, '0', clearAnimatingIn);\n};\n\nconst animatingOut = animateOut => {\n  animatingSetup(animateOut, '110%', clearAnimatingOut);\n};\n\nconst animatingOutPrevious = animateOut => {\n  setTimeout(() => {\n    animatingSetup(animateOut, '-110%', clearAnimatingOut);\n  }, 10);\n};\n\nconst animatingInPrevious = animateIn => {\n  animateIn.style.transform = 'translateX(110%)';\n  setTimeout(() => {\n    animatingSetup(animateIn, '0', clearAnimatingIn);\n  }, 10);\n};\n\nexport default items => {\n  let current = 0;\n  return {\n    next: () => {\n      const animateOut = items[current];\n      current = current + 1 >= items.length ? 0 : current + 1;\n      const animateIn = items[current];\n\n      animatingIn(animateIn);\n      animatingOut(animateOut);\n\n      return current;\n    },\n    previous: () => {\n      const animateOut = items[current];\n      current = current - 1 <= -1 ? items.length - 1 : current - 1;\n      const animateIn = items[current];\n\n      animatingInPrevious(animateIn);\n      animatingOutPrevious(animateOut);\n\n      return current;\n    },\n    select: n => {\n      const animateIn = items[n];\n      const animateOut = items[current];\n      current = n;\n\n      animatingIn(animateIn);\n      animatingOut(animateOut);\n\n      return current;\n    },\n  };\n};\n","const NAV_BTN = 'content-slider__button';\n\nconst generateArray = n => Array.apply(null, { length: n }).map(Number.call, Number);\n\nconst createButton = n => {\n  const withActive = n !== 0 ? NAV_BTN : `${NAV_BTN} ${NAV_BTN}--active`;\n  return `<li class='content-slider__nav-item'>\n    <button data-slide=\"${n}\" class=\"${withActive}\">\n      <span class=\"hidden\">Item ${n}</span>\n      <span class=\"hidden current\">${n === 0 ? 'current' : ''}</span>\n    </button>\n  </li>`;\n};\n\nconst createButtons = n => `<div class='content-slider__nav'>\n      <ul class='content-slider__nav-items'>\n        ${generateArray(n)\n          .map(createButton)\n          .join('')}\n      </ul>\n    </div>`;\n\nconst setActive = btns => active => {\n  btns.forEach((btn, i) => {\n    const current = btn.lastElementChild;\n    if (current) {\n      current.innerHTML = active === i ? 'current' : '';\n    }\n\n    if (active === i) {\n      btn.classList.add(`${NAV_BTN}--active`);\n    } else {\n      btn.classList.remove(`${NAV_BTN}--active`);\n    }\n  });\n};\n\nexport default (el, n, animater) => {\n  el.insertAdjacentHTML('beforeend', createButtons(n));\n\n  const btns = [...el.querySelectorAll(`.${NAV_BTN}`)];\n  const manageActive = setActive(btns);\n\n  btns.forEach(btn => {\n    btn.addEventListener('click', e => {\n      e.preventDefault();\n      const active = parseInt(btn.dataset.slide, 10);\n      manageActive(active);\n      animater.select(active);\n    });\n  });\n\n  return i => {\n    manageActive(i);\n  };\n};\n","import ViewportDetect from '@djforth/viewport-detection-fp';\nimport Animating from './animating';\nimport CreateNavDots from './nav_dots';\nimport TouchHandler from './touch_handler';\n\nconst setSlider = el => {\n  const items = [...el.querySelectorAll(`.${el.dataset.contentSlider}`)];\n  if (items.length <= 1) return;\n\n  items.forEach((item, i) => {\n    item.classList.add('content-slider');\n    if (i !== 0) {\n      item.setAttribute('aria-hidden', 'true');\n      item.style.transform = 'translateX(-110%)';\n    } else {\n      item.style.transform = 'translateX(0)';\n    }\n  });\n  const animate = Animating(items);\n  const setDots = CreateNavDots(el, items.length, animate);\n  TouchHandler(el, {\n    next: () => {\n      setDots(animate.next());\n    },\n    previous: () => {\n      console.count('trigger previous');\n      setDots(animate.previous());\n    },\n  });\n};\n\nconst resetSlider = el => {\n  const items = [...el.querySelectorAll(`.${el.dataset.contentSlider}`)];\n\n  items.forEach(item => {\n    item.classList.remove('content-slider');\n    item.removeAttribute('aria-hidden');\n    item.style.transform = '';\n  });\n\n  const nav = document.querySelector('.content-slider__nav');\n  if (nav) {\n    el.removeChild(nav);\n  }\n};\n\nexport default () => {\n  const sliders = [...document.querySelectorAll('[data-content-slider]')];\n\n  if (sliders.length === 0) return null;\n\n  const vpDetect = ViewportDetect();\n  if (vpDetect.getDevice() === 'mobile') {\n    sliders.forEach(setSlider);\n  }\n\n  vpDetect.addCallback(device => {\n    // trigger something\n    if (device === 'mobile') {\n      sliders.forEach(setSlider);\n    } else {\n      sliders.forEach(resetSlider);\n    }\n  });\n  vpDetect.track();\n};\n","const checkHorizontal = (start, end) => {\n  if (end > start + 100) return 'right';\n  if (end < start - 100) return 'left';\n  return 'none';\n};\n\nconst tracker = () => {\n  const start = { x: 0, y: 0 };\n  return (event, pos = 'start') => {\n    const { pageX, pageY } = event.changedTouches[0];\n    if (pos === 'start') {\n      start.x = pageX;\n      start.y = pageY;\n      return;\n    }\n\n    const distance = {\n      x: pageX - start.x,\n      y: pageY - start.y,\n    };\n\n    const direction = {\n      horizontal: checkHorizontal(start.x, pageX),\n      vertical: pageY > start.y + 100 ? 'down' : 'up',\n    };\n\n    return { distance, direction };\n  };\n};\n\nconst TouchStartHandler = handler => event => {\n  handler(event);\n};\n\nconst TouchEndHandler = (handler, next, previous) => event => {\n  const {\n    direction: { horizontal },\n  } = handler(event, 'end');\n\n  if (horizontal === 'left') {\n    previous();\n  } else if (horizontal === 'right') {\n    next();\n  }\n};\n\nexport default (element, { next, previous }) => {\n  const handler = tracker();\n  element.addEventListener('touchstart', TouchStartHandler(handler), false);\n  element.addEventListener('touchend', TouchEndHandler(handler, next, previous), false);\n};\n"],"names":["animatingSetup","el","moveTo","transitionend","classList","add","addEventListener","window","requestAnimationFrame","style","transform","clearAnimatingIn","target","removeEventListener","Element","remove","removeAttribute","clearAnimatingOut","setAttribute","animatingIn","animateIn","animatingOut","animateOut","items","current","next","length","previous","setTimeout","select","n","NAV_BTN","createButton","withActive","createButtons","Array","apply","map","Number","call","join","animater","insertAdjacentHTML","btns","querySelectorAll","manageActive","active","forEach","btn","i","lastElementChild","innerHTML","e","preventDefault","parseInt","dataset","slide","setSlider","contentSlider","item","element","start","handler","animate","Animating","setDots","CreateNavDots","console","count","x","y","event","end","pos","changedTouches","pageX","pageY","distance","direction","horizontal","vertical","resetSlider","nav","document","querySelector","removeChild","sliders","vpDetect","ViewportDetect","getDevice","addCallback","device","track"],"mappings":"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"}